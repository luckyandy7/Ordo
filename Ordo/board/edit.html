<!--
/**
 * ============================================
 * âœï¸ ORDO ê²Œì‹œê¸€ ìˆ˜ì • í˜ì´ì§€ (edit.html)
 * ============================================
 * 
 * ğŸ“ ëª©ì : ê¸°ì¡´ ê²Œì‹œê¸€ì„ ìˆ˜ì •í•˜ëŠ” í˜ì´ì§€
 * ğŸ¯ ê¸°ëŠ¥:
 *   - ê¸°ì¡´ ê²Œì‹œê¸€ ë°ì´í„° ë¡œë“œ ë° í‘œì‹œ
 *   - ì œëª©, ë‚´ìš©, ì¹´í…Œê³ ë¦¬ ìˆ˜ì •
 *   - íƒœê·¸ ìˆ˜ì •/ì¶”ê°€/ì‚­ì œ
 *   - ì´ë¯¸ì§€ ì¶”ê°€/ì‚­ì œ
 *   - ìˆ˜ì •ëœ ë‚´ìš© ì €ì¥
 *   - ì‘ì„±ì ê¶Œí•œ í™•ì¸
 * 
 * ğŸ”§ ì£¼ìš” ì»´í¬ë„ŒíŠ¸:
 *   - ê²Œì‹œê¸€ ìˆ˜ì • í¼ (ê¸°ì¡´ ë°ì´í„° pre-fill)
 *   - ì¹´í…Œê³ ë¦¬ ì„ íƒê¸°
 *   - íƒœê·¸ ê´€ë¦¬ ì‹œìŠ¤í…œ
 *   - ì´ë¯¸ì§€ ì—…ë¡œë“œ/ì‚­ì œ ê¸°ëŠ¥
 *   - ì €ì¥/ì·¨ì†Œ ë²„íŠ¼
 * 
 * ğŸ¨ ë””ìì¸ íŠ¹ì§•:
 *   - write.htmlê³¼ ë™ì¼í•œ UI/UX
 *   - ìˆ˜ì • ì¤‘ì„ì„ ëª…ì‹œí•˜ëŠ” í—¤ë”
 *   - ê¸°ì¡´ ë°ì´í„° í‘œì‹œ
 *   - ë³€ê²½ì‚¬í•­ í™•ì¸ ê°€ëŠ¥
 * 
 * ğŸ”— ì—°ê´€ íŒŒì¼:
 *   - write.html (ìƒˆ ê¸€ ì‘ì„±)
 *   - view.html (ê²Œì‹œê¸€ ìƒì„¸ë³´ê¸°)
 *   - list.html (ê²Œì‹œê¸€ ëª©ë¡)
 * 
 * ì‘ì„±ì¼: 2025ë…„ 6ì›” 10ì¼
 * ì‘ì„±ì: ORDO ê°œë°œíŒ€
 * ë²„ì „: 1.0
 */
-->
<!DOCTYPE html>
<html lang="ko" style="color-scheme: light;">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ê²Œì‹œê¸€ ìˆ˜ì • - Ordo ì»¤ë®¤ë‹ˆí‹°</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Cutive:wght@400&family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      @font-face {
        font-family: "Freesentation";
        src: url("/font/Freesentation.ttf") format("truetype");
      }

      :root {
        /* Ordo ë©”ì¸ ìƒ‰ìƒ í…Œë§ˆ */
        --primary-color: #c96342;
        --primary-light: #faf4f2;
        --primary-dark: #a84f35;
        --background-color: #f6f0eb;
        --surface-color: #ffffff;
        --gray-color: #797979;
        --light-gray: #a0a0a0;
        --border-color: #e0e0e0;
        --hover-color: #f0f0f0;
        --shadow-color: rgba(201, 99, 66, 0.1);
        --text-primary: #2d2419;
        --text-secondary: #6b5b47;
        --text-muted: #9ca3af;
        --success: #10b981;
        --error: #ef4444;
        --warning: #f59e0b;

        /* êµ¬ë¦¬ìƒ‰ ê³„ì—´ í™•ì¥ */
        --copper-accent: #cd7f32;
        --copper-light: #d4a574;
        --copper-dark: #8b5a2b;
        --copper-soft: #f4ede5;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Freesentation", "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        line-height: 1.6;
        color: var(--text-primary);
        background: linear-gradient(135deg, var(--background-color) 0%, var(--primary-light) 50%, #f0e6e1 100%);
        background-attachment: fixed;
        min-height: 100vh;
        /* ë¼ì´íŠ¸ëª¨ë“œ ê°•ì œ ê³ ì • */
        color-scheme: light;
      }

      .header {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid var(--border-color);
        position: sticky;
        top: 0;
        z-index: 100;
        box-shadow: 0 4px 12px var(--shadow-color);
      }

      .header-content {
        max-width: 1200px;
        margin: 0 auto;
        padding: 1rem 2rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .brand-container {
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .logo-image {
        width: 40px;
        height: 40px;
        border-radius: 8px;
        transition: transform 0.3s ease;
      }

      .logo-image:hover {
        transform: rotate(15deg);
      }

      .brand {
        font-family: "Cutive", serif;
        font-size: 1.8rem;
        font-weight: 400;
        color: var(--primary-color);
        text-decoration: none;
        letter-spacing: -0.025em;
        transition: color 0.3s ease;
      }

      .brand:hover {
        color: var(--primary-dark);
      }

      .nav-breadcrumb {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.875rem;
        color: var(--text-secondary);
        background: var(--copper-soft);
        padding: 0.5rem 1rem;
        border-radius: 20px;
        border: 1px solid var(--copper-light);
      }

      .breadcrumb-link {
        color: var(--text-secondary);
        text-decoration: none;
        transition: color 0.2s;
        font-weight: 500;
      }

      .breadcrumb-link:hover {
        color: var(--primary-color);
      }

      .breadcrumb-separator {
        color: var(--copper-accent);
        font-weight: 600;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
        padding: 3rem 2rem;
      }

      .page-header {
        text-align: center;
        margin-bottom: 3rem;
        position: relative;
      }

      .page-header::before {
        content: '';
        position: absolute;
        top: -20px;
        left: 50%;
        transform: translateX(-50%);
        width: 60px;
        height: 4px;
        background: linear-gradient(90deg, var(--primary-color), var(--copper-accent));
        border-radius: 2px;
      }

      .page-title {
        font-family: "Cutive", serif;
        font-size: 2.5rem;
        font-weight: 400;
        color: var(--primary-color);
        margin-bottom: 0.5rem;
        letter-spacing: -0.025em;
        text-shadow: 0 2px 4px rgba(201, 99, 66, 0.15);
      }

      .page-subtitle {
        color: var(--text-secondary);
        font-size: 1.1rem;
        font-weight: 400;
      }

      .form-container {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border-radius: 24px;
        box-shadow: 
          0 20px 40px rgba(201, 99, 66, 0.08),
          0 8px 16px rgba(201, 99, 66, 0.04),
          inset 0 1px 0 rgba(255, 255, 255, 0.8);
        border: 1px solid rgba(201, 99, 66, 0.1);
        overflow: hidden;
        position: relative;
        /* ë¼ì´íŠ¸ëª¨ë“œ ê°•ì œ ê³ ì • */
        color-scheme: light;
      }

      .form-container::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--primary-color), var(--copper-accent), var(--primary-color));
      }

      .form-header {
        padding: 2rem 2.5rem 1.5rem;
        border-bottom: 1px solid rgba(201, 99, 66, 0.1);
        background: linear-gradient(135deg, var(--primary-light), rgba(250, 244, 242, 0.8));
      }

      .form-title {
        font-family: "Cutive", serif;
        font-size: 1.5rem;
        font-weight: 400;
        color: var(--primary-color);
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .form-icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, var(--primary-color), var(--copper-accent));
        border-radius: 12px;
        color: white;
        font-size: 1.1rem;
      }

      .form-description {
        color: var(--text-secondary);
        font-size: 0.95rem;
        font-weight: 400;
      }

      .form-content {
        padding: 2.5rem;
      }

      .form-group {
        margin-bottom: 2rem;
        position: relative;
      }

      .form-label {
        display: block;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 0.75rem;
        font-size: 0.95rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .required {
        color: var(--error);
        font-weight: 700;
      }

      .label-icon {
        color: var(--copper-accent);
        font-size: 0.9rem;
      }

      .form-input {
        width: 100%;
        padding: 1rem 1.25rem;
        border: 2px solid var(--border-color);
        border-radius: 16px;
        font-size: 1rem;
        line-height: 1.5;
        transition: all 0.3s ease;
        background: var(--surface-color);
        font-family: inherit;
        color: var(--text-primary);
        /* ë¼ì´íŠ¸ëª¨ë“œ ê°•ì œ ê³ ì • */
        color-scheme: light;
      }

      .form-input:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 
          0 0 0 4px rgba(201, 99, 66, 0.1),
          0 8px 24px rgba(201, 99, 66, 0.12);
        transform: translateY(-2px);
      }

      .form-textarea {
        min-height: 240px;
        resize: vertical;
        font-family: inherit;
        line-height: 1.8;
      }

      .category-group {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-top: 0.75rem;
      }

      .category-option {
        position: relative;
      }

      .category-radio {
        position: absolute;
        opacity: 0;
        pointer-events: none;
      }

      .category-label {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 1rem 1.25rem;
        border: 2px solid var(--border-color);
        border-radius: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        background: var(--surface-color);
        font-weight: 500;
        color: var(--text-secondary);
      }

      .category-label:hover {
        border-color: var(--primary-color);
        background: var(--copper-soft);
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(201, 99, 66, 0.12);
      }

      .category-radio:checked + .category-label {
        border-color: var(--primary-color);
        background: linear-gradient(135deg, var(--primary-color), var(--copper-accent));
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(201, 99, 66, 0.2);
      }

      .category-icon {
        font-size: 1.2rem;
        width: 24px;
        text-align: center;
      }

      .form-buttons {
        display: flex;
        gap: 1rem;
        justify-content: center;
        margin-top: 3rem;
        padding-top: 2rem;
        border-top: 1px solid rgba(201, 99, 66, 0.1);
      }

      .btn {
        padding: 1rem 2rem;
        border: none;
        border-radius: 16px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        min-width: 140px;
        font-family: inherit;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }

      .btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.5s ease;
      }

      .btn:hover::before {
        left: 100%;
      }

      .submit-btn {
        background: linear-gradient(135deg, var(--primary-color), var(--copper-accent));
        color: white;
        box-shadow: 0 8px 24px rgba(201, 99, 66, 0.2);
      }

      .submit-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 32px rgba(201, 99, 66, 0.3);
      }

      .submit-btn:active {
        transform: translateY(-1px);
      }

      .cancel-btn {
        background: var(--surface-color);
        color: var(--text-secondary);
        border: 2px solid var(--border-color);
      }

      .cancel-btn:hover {
        background: var(--copper-soft);
        border-color: var(--copper-accent);
        color: var(--primary-color);
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(201, 99, 66, 0.12);
      }

      .delete-btn {
        background: linear-gradient(135deg, var(--error), #dc2626);
        color: white;
        box-shadow: 0 8px 24px rgba(239, 68, 68, 0.2);
      }

      .delete-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 32px rgba(239, 68, 68, 0.3);
      }

      .loading-state {
        display: none;
        text-align: center;
        padding: 2rem;
        color: var(--text-secondary);
      }

      .loading-spinner {
        display: inline-block;
        width: 40px;
        height: 40px;
        border: 4px solid var(--border-color);
        border-top: 4px solid var(--primary-color);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 1rem;
      }

      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      /* ë°˜ì‘í˜• ë””ìì¸ */
      @media (max-width: 768px) {
        .container {
          padding: 2rem 1rem;
        }

        .header-content {
          padding: 1rem;
        }

        .brand {
          font-size: 1.5rem;
        }

        .page-title {
          font-size: 2rem;
        }

        .form-content {
          padding: 2rem 1.5rem;
        }

        .form-header {
          padding: 1.5rem;
        }

        .form-buttons {
          flex-direction: column;
        }

        .category-group {
          grid-template-columns: 1fr;
        }

        .nav-breadcrumb {
          display: none;
        }
      }

      /* ë¼ì´íŠ¸ëª¨ë“œ ê³ ì • - ë‹¤í¬ëª¨ë“œ ì œê±° */

      /* ì ‘ê·¼ì„± í–¥ìƒ */
      .btn:focus {
        outline: 3px solid rgba(201, 99, 66, 0.3);
        outline-offset: 2px;
      }

      .form-input:focus {
        outline: 3px solid rgba(201, 99, 66, 0.3);
        outline-offset: 2px;
      }

      /* ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ */
      .form-container {
        animation: slideInUp 0.6s ease-out;
      }

      @keyframes slideInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .page-header {
        animation: fadeIn 0.8s ease-out 0.2s both;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>  <body>
    <!-- ğŸ“Œ ìƒë‹¨ í—¤ë”: ë¸Œëœë“œëª… + ë¸Œë ˆë“œí¬ëŸ¼ ë„¤ë¹„ê²Œì´ì…˜ -->
    <header class="header">
      <div class="header-content">
        <div class="brand-container">
          <img src="/Login/image-8.png" alt="Ordo Logo" class="logo-image" />
          <a href="/Main/index.html" class="brand">Ordo</a>
        </div>
        <!-- ğŸ—ºï¸ ë¸Œë ˆë“œí¬ëŸ¼ ë„¤ë¹„ê²Œì´ì…˜ (í™ˆ > ì»¤ë®¤ë‹ˆí‹° > ìˆ˜ì •) -->
        <nav class="nav-breadcrumb">
          <a href="/Main/index.html" class="breadcrumb-link">
            <i class="fas fa-home"></i> í™ˆ
          </a>
          <span class="breadcrumb-separator">â€¢</span>
          <a href="/board/list.html" class="breadcrumb-link">
            <i class="fas fa-comments"></i> ì»¤ë®¤ë‹ˆí‹°
          </a>
          <span class="breadcrumb-separator">â€¢</span>
          <span class="breadcrumb-current">
            <i class="fas fa-edit"></i> ê²Œì‹œê¸€ ìˆ˜ì •
          </span>
        </nav>
      </div>
    </header>    <!-- ğŸ  ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
    <div class="container">
      <!-- âœï¸ í˜ì´ì§€ í—¤ë” -->
      <div class="page-header">
        <h1 class="page-title">ê²Œì‹œê¸€ ìˆ˜ì •</h1>
        <p class="page-subtitle">ë‚´ìš©ì„ ìˆ˜ì •í•˜ê³  ì»¤ë®¤ë‹ˆí‹°ì™€ ë‹¤ì‹œ ê³µìœ í•˜ì„¸ìš”</p>
      </div>

      <!-- ğŸ“ ê²Œì‹œê¸€ ìˆ˜ì • í¼ ì»¨í…Œì´ë„ˆ -->
      <div class="form-container">        <!-- ğŸ“‹ í¼ í—¤ë” -->
        <div class="form-header">
          <h2 class="form-title">
            <span class="form-icon">
              <i class="fas fa-edit"></i>
            </span>
            ê²Œì‹œê¸€ í¸ì§‘
          </h2>
          <p class="form-description">
            ê²Œì‹œê¸€ì˜ ë‚´ìš©ì„ ììœ ë¡­ê²Œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë³€ê²½ì‚¬í•­ì€ ì¦‰ì‹œ ë°˜ì˜ë©ë‹ˆë‹¤.
          </p>
        </div>

        <div class="form-content">
          <form id="editForm" enctype="multipart/form-data">
            <div class="form-group">
              <label for="title" class="form-label">
                <i class="fas fa-heading label-icon"></i>
                ì œëª© <span class="required">*</span>
              </label>
              <input
                type="text"
                id="title"
                name="title"
                class="form-input"
                placeholder="ê²Œì‹œê¸€ì˜ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"
                required
              />
            </div>

            <div class="form-group">
              <label class="form-label">
                <i class="fas fa-tag label-icon"></i>
                ì¹´í…Œê³ ë¦¬ <span class="required">*</span>
              </label>
              <div class="category-group">
                <div class="category-option">
                  <input
                    type="radio"
                    id="productivity"
                    name="category"
                    value="productivity"
                    class="category-radio"
                    required
                  />
                  <label for="productivity" class="category-label">
                    <span class="category-icon">ğŸ“ˆ</span>
                    ìƒì‚°ì„±
                  </label>
                </div>
                <div class="category-option">
                  <input
                    type="radio"
                    id="routine"
                    name="category"
                    value="routine"
                    class="category-radio"
                  />
                  <label for="routine" class="category-label">
                    <span class="category-icon">ğŸ”„</span>
                    ë£¨í‹´
                  </label>
                </div>
                <div class="category-option">
                  <input
                    type="radio"
                    id="tips"
                    name="category"
                    value="tips"
                    class="category-radio"
                  />
                  <label for="tips" class="category-label">
                    <span class="category-icon">ğŸ’¡</span>
                    íŒ & ë…¸í•˜ìš°
                  </label>
                </div>
                <div class="category-option">
                  <input
                    type="radio"
                    id="qna"
                    name="category"
                    value="qna"
                    class="category-radio"
                  />
                  <label for="qna" class="category-label">
                    <span class="category-icon">â“</span>
                    ì§ˆë¬¸ & ë‹µë³€
                  </label>
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="content" class="form-label">
                <i class="fas fa-align-left label-icon"></i>
                ë‚´ìš© <span class="required">*</span>
              </label>
              <textarea
                id="content"
                name="content"
                class="form-input form-textarea"
                placeholder="ê²Œì‹œê¸€ì˜ ë‚´ìš©ì„ ìì„¸íˆ ì‘ì„±í•´ ì£¼ì„¸ìš”. ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì—ê²Œ ë„ì›€ì´ ë˜ëŠ” ì •ë³´ë¥¼ ê³µìœ í•´ë³´ì„¸ìš”!"
                required
              ></textarea>
            </div>

            <div class="form-group">
              <label for="images" class="form-label">
                <i class="fas fa-images label-icon"></i>
                ì´ë¯¸ì§€ ì²¨ë¶€ (ì„ íƒì‚¬í•­)
              </label>
              <input
                type="file"
                id="images"
                name="images"
                class="form-input"
                multiple
                accept="image/*"
              />
              <div id="imagePreview" class="image-preview"></div>
            </div>

            <div class="loading-state" id="loadingState">
              <div class="loading-spinner"></div>
              <p>ê²Œì‹œê¸€ì„ ìˆ˜ì •í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
            </div>

            <div class="form-buttons">
              <button type="button" class="btn cancel-btn" onclick="goBack()">
                <i class="fas fa-times"></i>
                ì·¨ì†Œ
              </button>
              <button type="button" class="btn delete-btn" onclick="deletePost()">
                <i class="fas fa-trash"></i>
                ì‚­ì œ
              </button>
              <button type="submit" class="btn submit-btn">
                <i class="fas fa-save"></i>
                ìˆ˜ì • ì™„ë£Œ
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>    <!-- âš™ï¸ JavaScript: ê²Œì‹œê¸€ ìˆ˜ì • ê¸°ëŠ¥ êµ¬í˜„ -->
    <script>
      /**
       * ğŸŒ ì „ì—­ ë³€ìˆ˜ ì„ ì–¸
       */
      let postId = null;          // ìˆ˜ì •í•  ê²Œì‹œê¸€ ID
      let currentPost = null;     // í˜„ì¬ ê²Œì‹œê¸€ ì •ë³´

      /**
       * ğŸ“‹ ì´ˆê¸°í™”: URLì—ì„œ ê²Œì‹œê¸€ ID ì¶”ì¶œ ë° ì¸ì¦ í™•ì¸
       */
      // URLì—ì„œ postId ì¶”ì¶œ
      const urlParams = new URLSearchParams(window.location.search);
      postId = urlParams.get('id');

      if (!postId) {
        alert('ê²Œì‹œê¸€ IDê°€ ì—†ìŠµë‹ˆë‹¤.');
        location.href = '/board/list.html';
      }

      // ì‚¬ìš©ì ì¸ì¦ í™•ì¸
      const token = localStorage.getItem('token');
      if (!token) {
        alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
        location.href = '/Login/email-login.html';
      }

      /**
       * ğŸ“± í˜ì´ì§€ ë¡œë”© ì™„ë£Œ í›„ ê²Œì‹œê¸€ ë°ì´í„° ë¡œë“œ
       */
      document.addEventListener('DOMContentLoaded', function() {
        loadPostData();
      });

      /**
       * ğŸ“– ê²Œì‹œê¸€ ë°ì´í„° ë¡œë“œ í•¨ìˆ˜
       * - ì„œë²„ì—ì„œ ê²Œì‹œê¸€ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
       * - ì‘ì„±ì ê¶Œí•œ í™•ì¸
       * - í¼ì— ê¸°ì¡´ ë°ì´í„° ì±„ìš°ê¸°
       */
      async function loadPostData() {
        try {
          console.log('ê²Œì‹œê¸€ ë¡œë”© ì‹œì‘:', postId);
          
          const response = await fetch(`/api/posts/${postId}`, {
            headers: {
              'Authorization': `Bearer ${token}`
            }
          });

          console.log('ì‘ë‹µ ìƒíƒœ:', response.status);

          if (!response.ok) {
            const errorText = await response.text();
            console.error('ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜:', errorText);
            throw new Error(`ê²Œì‹œê¸€ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (${response.status})`);
          }

          const data = await response.json();
          console.log('ë°›ì€ ë°ì´í„°:', data);
          
          const post = data.post || data; // ë°ì´í„° êµ¬ì¡°ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ì²˜ë¦¬
          currentPost = post; // ì „ì—­ ë³€ìˆ˜ì— ì €ì¥

          // ì‘ì„±ì ê¶Œí•œ í™•ì¸
          const user = getUserInfo();
          const userIdentifier = getUserIdentifier();
          console.log('í˜„ì¬ ì‚¬ìš©ì:', user);
          console.log('í˜„ì¬ ì‚¬ìš©ì ì‹ë³„ì:', userIdentifier);
          console.log('ê²Œì‹œê¸€ ì‘ì„±ì:', post.author);
          
          if (!user || !userIdentifier) {
            alert('ì‚¬ìš©ì ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.');
            location.href = '/Login/email-login.html';
            return;
          }

          // authorê°€ ë¬¸ìì—´ì¸ì§€ ê°ì²´ì¸ì§€ í™•ì¸í•˜ì—¬ ì ì ˆíˆ ì²˜ë¦¬
          const postAuthor = typeof post.author === 'object' ? post.author.email || post.author.name : post.author;
          
          // ì´ë©”ì¼ ë˜ëŠ” ì´ë¦„ìœ¼ë¡œ ì‘ì„±ì í™•ì¸
          const isAuthor = (user.email && postAuthor === user.email) || 
                          (user.name && postAuthor === user.name) ||
                          postAuthor === userIdentifier;
          
          if (!isAuthor) {
            alert('ê²Œì‹œê¸€ ìˆ˜ì • ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.');
            location.href = '/board/list.html';
            return;
          }

          // í¼ì— ê¸°ì¡´ ë°ì´í„° ì±„ìš°ê¸°
          document.getElementById('title').value = post.title || '';
          document.getElementById('content').value = post.content || '';
          
          // ì¹´í…Œê³ ë¦¬ ì„¤ì •
          if (post.category) {
            const categoryRadio = document.querySelector(`input[name="category"][value="${post.category}"]`);
            if (categoryRadio) {
              categoryRadio.checked = true;
            }
          }

          console.log('ê²Œì‹œê¸€ ë°ì´í„° ë¡œë”© ì™„ë£Œ');

        } catch (error) {
          console.error('ê²Œì‹œê¸€ ë¡œë”© ì˜¤ë¥˜:', error);
          alert(`ê²Œì‹œê¸€ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${error.message}`);
          location.href = '/board/list.html';
        }
      }

      /**
       * ğŸ’¾ ê²Œì‹œê¸€ ìˆ˜ì • ì²˜ë¦¬ í•¨ìˆ˜
       * - í¼ ë°ì´í„° ê²€ì¦
       * - ì„œë²„ì— ìˆ˜ì •ëœ ë°ì´í„° ì „ì†¡
       * - ì„±ê³µ ì‹œ ìƒì„¸ë³´ê¸° í˜ì´ì§€ë¡œ ì´ë™
       */

      // í¼ ì œì¶œ ì²˜ë¦¬
      document.getElementById('editForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        // í¼ ìœ íš¨ì„± ê²€ì‚¬
        const title = document.getElementById('title').value.trim();
        const content = document.getElementById('content').value.trim();
        const selectedCategory = document.querySelector('input[name="category"]:checked');
        
        if (!title) {
          alert('ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
          document.getElementById('title').focus();
          return;
        }
        
        if (!content) {
          alert('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
          document.getElementById('content').focus();
          return;
        }
        
        if (!selectedCategory) {
          alert('ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
          return;
        }
        
        const loadingState = document.getElementById('loadingState');
        const formButtons = document.querySelector('.form-buttons');
        
        // ë¡œë”© ìƒíƒœ í‘œì‹œ
        loadingState.style.display = 'block';
        formButtons.style.display = 'none';

        try {
          const formData = new FormData();
          formData.append('title', title);
          formData.append('content', content);
          formData.append('category', selectedCategory.value);

          // ì´ë¯¸ì§€ íŒŒì¼ë“¤ ì¶”ê°€
          const imageFiles = document.getElementById('images').files;
          for (let i = 0; i < imageFiles.length; i++) {
            formData.append('images', imageFiles[i]);
          }

          // ì‘ì„±ì í™•ì¸ì„ ìœ„í•œ ì •ë³´ ì¶”ê°€ - URL ì¿¼ë¦¬ë¡œ ì „ì†¡
          const user = getUserInfo();
          const postAuthor = typeof currentPost.author === 'object' ? currentPost.author.email || currentPost.author.name : currentPost.author;
          
          const response = await fetch(`/api/posts/${postId}?authorCheck=${encodeURIComponent(postAuthor)}`, {
            method: 'PUT',
            headers: {
              'Authorization': `Bearer ${token}`
            },
            body: formData
          });

          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.message || 'ê²Œì‹œê¸€ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
          }

          const result = await response.json();
          alert('ê²Œì‹œê¸€ì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!');
          location.href = `/board/view.html?id=${postId}`;

        } catch (error) {
          console.error('Error updating post:', error);
          alert(error.message || 'ê²Œì‹œê¸€ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        } finally {
          // ë¡œë”© ìƒíƒœ ìˆ¨ê¸°ê¸°
          loadingState.style.display = 'none';
          formButtons.style.display = 'flex';
        }
      });

      // ê²Œì‹œê¸€ ì‚­ì œ
      async function deletePost() {
        if (!confirm('ì •ë§ë¡œ ì´ ê²Œì‹œê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
          return;
        }

        try {
          const user = getUserInfo();
          const postAuthor = typeof currentPost.author === 'object' ? currentPost.author.email || currentPost.author.name : currentPost.author;
          const response = await fetch(`/api/posts/${postId}?authorCheck=${encodeURIComponent(postAuthor)}`, {
            method: 'DELETE',
            headers: {
              'Authorization': `Bearer ${token}`
            }
          });

          if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.message || 'ê²Œì‹œê¸€ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
          }

          alert('ê²Œì‹œê¸€ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
          location.href = '/board/list.html';

        } catch (error) {
          console.error('Error deleting post:', error);
          alert(error.message || 'ê²Œì‹œê¸€ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        }
      }

      // ì·¨ì†Œ ë²„íŠ¼
      function goBack() {
        if (confirm('ìˆ˜ì •ì„ ì·¨ì†Œí•˜ê³  ì´ì „ í˜ì´ì§€ë¡œ ëŒì•„ê°€ì‹œê² ìŠµë‹ˆê¹Œ?')) {
          location.href = `/board/view.html?id=${postId}`;
        }
      }

      // localStorageì—ì„œ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°
      function getUserInfo() {
        try {
          const userString = localStorage.getItem('user');
          if (!userString) {
            console.error('localStorageì— ì‚¬ìš©ì ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.');
            return null;
          }
          
          const user = JSON.parse(userString);
          console.log('localStorage ì‚¬ìš©ì ì •ë³´:', user); // ë””ë²„ê¹…ìš©
          return user;
        } catch (error) {
          console.error('ì‚¬ìš©ì ì •ë³´ íŒŒì‹± ì˜¤ë¥˜:', error);
          return null;
        }
      }

      // ì‚¬ìš©ì ì´ë©”ì¼ ë˜ëŠ” ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
      function getUserIdentifier() {
        const user = getUserInfo();
        if (!user) return null;
        
        // ì´ë©”ì¼ì´ ìˆìœ¼ë©´ ì´ë©”ì¼ì„, ì—†ìœ¼ë©´ ì´ë¦„ì„ ë°˜í™˜
        return user.email || user.name || null;
      }

      // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° (ì¶”í›„ êµ¬í˜„ ì‹œ ì‚¬ìš©)
      document.getElementById('images').addEventListener('change', function(e) {
        const preview = document.getElementById('imagePreview');
        preview.innerHTML = '';
        
        Array.from(e.target.files).forEach(file => {
          if (file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = function(e) {
              const img = document.createElement('img');
              img.src = e.target.result;
              img.style.cssText = 'max-width: 100px; max-height: 100px; margin: 5px; border-radius: 8px; object-fit: cover;';
              preview.appendChild(img);
            };
            reader.readAsDataURL(file);
          }
        });
      });

      // í˜ì´ì§€ ì§„ì… ì• ë‹ˆë©”ì´ì…˜
      document.body.style.opacity = '0';
      window.addEventListener('load', function() {
        document.body.style.transition = 'opacity 0.5s ease';
        document.body.style.opacity = '1';
      });
    </script>
  </body>
</html> 