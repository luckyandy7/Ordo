<!--
/**
 * ============================================
 * üëÅÔ∏è ORDO Í≤åÏãúÍ∏Ä ÏÉÅÏÑ∏Î≥¥Í∏∞ ÌéòÏù¥ÏßÄ (view.html)
 * ============================================
 * 
 * üìñ Î™©Ï†Å: ÏÑ†ÌÉùÌïú Í≤åÏãúÍ∏ÄÏùò ÏÉÅÏÑ∏ ÎÇ¥Ïö©ÏùÑ ÌëúÏãúÌïòÎäî ÌéòÏù¥ÏßÄ
 * üéØ Í∏∞Îä•:
 *   - Í≤åÏãúÍ∏Ä Ï†ÑÏ≤¥ ÎÇ¥Ïö© ÌëúÏãú
 *   - ÏûëÏÑ±Ïûê Ï†ïÎ≥¥ Î∞è Î©îÌÉÄÎç∞Ïù¥ÌÑ∞ ÌëúÏãú
 *   - Ï¢ãÏïÑÏöî Í∏∞Îä•
 *   - ÎåìÍ∏Ä ÏãúÏä§ÌÖú (ÏûëÏÑ±, ÏàòÏ†ï, ÏÇ≠Ï†ú)
 *   - Í≤åÏãúÍ∏Ä ÏàòÏ†ï/ÏÇ≠Ï†ú (ÏûëÏÑ±ÏûêÎßå)
 *   - Ïù¥ÎØ∏ÏßÄ Î™®Îã¨ Î∑∞Ïñ¥
 *   - ÌÉúÍ∑∏ ÏãúÏä§ÌÖú
 * 
 * üîß Ï£ºÏöî Ïª¥Ìè¨ÎÑåÌä∏:
 *   - Í≤åÏãúÍ∏Ä Ìó§Îçî (Ï†úÎ™©, ÏûëÏÑ±Ïûê, ÎÇ†Ïßú, Ïπ¥ÌÖåÍ≥†Î¶¨)
 *   - Í≤åÏãúÍ∏Ä Î≥∏Î¨∏ (ÎÇ¥Ïö©, Ïù¥ÎØ∏ÏßÄ)
 *   - Ïï°ÏÖò Î≤ÑÌäº (Ï¢ãÏïÑÏöî, ÏàòÏ†ï, ÏÇ≠Ï†ú)
 *   - Ï¢ãÏïÑÏöî Î™©Î°ù ÏÑπÏÖò
 *   - ÎåìÍ∏Ä ÏÑπÏÖò (Î™©Î°ù, ÏûëÏÑ± Ìèº)
 * 
 * üé® ÎîîÏûêÏù∏ ÌäπÏßï:
 *   - ÏùΩÍ∏∞ Ìé∏Ìïú ÌÉÄÏù¥Ìè¨Í∑∏ÎûòÌîº
 *   - Ïπ¥Îìú Í∏∞Î∞ò Î†àÏù¥ÏïÑÏõÉ
 *   - Ïù∏ÌÑ∞ÎûôÌã∞Î∏å ÏöîÏÜå (Ï¢ãÏïÑÏöî, ÎåìÍ∏Ä)
 *   - Ïù¥ÎØ∏ÏßÄ ÌôïÎåÄ Î≥¥Í∏∞ Î™®Îã¨
 * 
 * üîó Ïó∞Í¥Ä ÌååÏùº:
 *   - list.html (Í≤åÏãúÍ∏Ä Î™©Î°ù)
 *   - write.html (Í≤åÏãúÍ∏Ä ÏûëÏÑ±)
 *   - edit.html (Í≤åÏãúÍ∏Ä ÏàòÏ†ï)
 * 
 * ÏûëÏÑ±Ïùº: 2025ÎÖÑ 6Ïõî 10Ïùº
 * ÏûëÏÑ±Ïûê: ORDO Í∞úÎ∞úÌåÄ
 * Î≤ÑÏ†Ñ: 1.0
 */
-->
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ordo - Í≤åÏãúÍ∏Ä Î≥¥Í∏∞</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Cutive:wght@400&family=Inter:wght@300;400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />
    <style>
      @font-face {
        font-family: "Freesentation";
        src: url("/font/Freesentation.ttf") format("truetype");
      }

      :root {
        /* Ordo Signature Colors */
        --copper-primary: #c96342;
        --copper-light: #e08b6f;
        --copper-dark: #a54a2e;
        --copper-bright: #f2a085;
        --copper-shadow: rgba(201, 99, 66, 0.15);

        /* Modern Neutral Palette */
        --gray-50: #fafafa;
        --gray-100: #f5f5f5;
        --gray-200: #e5e5e5;
        --gray-300: #d4d4d4;
        --gray-400: #a3a3a3;
        --gray-500: #737373;
        --gray-600: #525252;
        --gray-700: #404040;
        --gray-800: #262626;
        --gray-900: #171717;

        /* Theme Colors */
        --background: #f6f0eb;
        --surface: #ffffff;
        --surface-hover: #f5f5f5;
        --border: #e5e5e5;
        --text-primary: #171717;
        --text-secondary: #525252;
        --text-muted: #a3a3a3;

        /* Shadows */
        --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1),
          0 2px 4px -2px rgb(0 0 0 / 0.1);
        --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1),
          0 4px 6px -4px rgb(0 0 0 / 0.1);
        --shadow-copper: 0 4px 14px 0 rgba(201, 99, 66, 0.15);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", "Freesentation", -apple-system, BlinkMacSystemFont,
          sans-serif;
        background: linear-gradient(
          135deg,
          var(--background) 0%,
          #faf4f2 50%,
          #f0e6e1 100%
        );
        background-attachment: fixed;
        color: var(--text-primary);
        line-height: 1.6;
        min-height: 100vh;
      }

      .header {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid var(--border);
        padding: 1rem 0;
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .header-content {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .brand-container {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .logo-image {
        width: 40px;
        height: 40px;
        transition: transform 0.3s ease;
      }

      .logo-image:hover {
        transform: rotate(15deg);
      }

      .brand {
        font-family: "Cutive", serif;
        font-size: 1.8rem;
        color: var(--copper-primary);
        font-weight: 400;
        text-decoration: none;
      }

      .nav-breadcrumb {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--text-secondary);
        font-size: 0.875rem;
      }

      .breadcrumb-link {
        color: var(--text-secondary);
        text-decoration: none;
        transition: color 0.2s ease;
      }

      .breadcrumb-link:hover {
        color: var(--copper-primary);
      }

      .container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 3rem 2rem;
      }

      .post-container {
        background: var(--surface);
        border-radius: 16px;
        box-shadow: var(--shadow-lg);
        overflow: hidden;
        margin-bottom: 2rem;
      }

      .post-header {
        padding: 2rem;
        border-bottom: 1px solid var(--border);
      }

      .post-category {
        display: inline-block;
        background: var(--copper-primary);
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 16px;
        font-size: 0.8rem;
        margin-bottom: 1rem;
      }

      .post-title {
        font-family: "Cutive", serif;
        font-size: 2.5rem;
        color: var(--text-primary);
        margin-bottom: 1.5rem;
        line-height: 1.2;
      }

      .post-meta {
        display: flex;
        align-items: center;
        gap: 1.5rem;
        flex-wrap: wrap;
        color: var(--text-secondary);
        font-size: 0.875rem;
        margin-bottom: 1rem;
      }

      .meta-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .author-info {
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .author-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background: var(--copper-primary);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        font-size: 0.875rem;
      }

      .post-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-top: 1rem;
      }

      .tag {
        background: var(--gray-100);
        color: var(--text-secondary);
        padding: 0.25rem 0.75rem;
        border-radius: 16px;
        font-size: 0.8rem;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .tag:hover {
        background: var(--copper-light);
        color: white;
      }

      .post-content {
        padding: 2rem;
        font-size: 1.125rem;
        line-height: 1.8;
        color: var(--text-primary);
        word-break: break-word;
      }

      .post-content p {
        margin-bottom: 1.5rem;
      }

      .post-content ul,
      .post-content ol {
        margin-bottom: 1.5rem;
        padding-left: 2rem;
      }

      .post-content li {
        margin-bottom: 0.5rem;
      }

      .post-actions {
        padding: 1.5rem 2rem;
        border-top: 1px solid var(--border);
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: var(--gray-50);
      }

      .action-buttons {
        display: flex;
        gap: 1rem;
      }

      .btn {
        padding: 0.5rem 1rem;
        border-radius: 8px;
        text-decoration: none;
        font-size: 0.875rem;
        font-weight: 500;
        transition: all 0.2s ease;
        cursor: pointer;
        border: none;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }

      .btn-secondary {
        background: var(--surface);
        color: var(--text-secondary);
        border: 1px solid var(--border);
      }

      .btn-secondary:hover {
        background: var(--surface-hover);
        border-color: var(--copper-primary);
      }

      .btn-primary {
        background: var(--copper-primary);
        color: white;
      }

      .btn-primary:hover {
        background: var(--copper-dark);
      }

      .btn-warning {
        background: #f59e0b;
        color: white;
      }

      .btn-warning:hover {
        background: #d97706;
      }

      .btn-danger {
        background: #ef4444;
        color: white;
      }

      .btn-danger:hover {
        background: #dc2626;
      }

      #authorActions {
        display: flex;
        gap: 0.5rem;
        margin-left: 1rem;
      }

      .btn-like {
        background: var(--surface);
        color: var(--text-secondary);
        border: 2px solid var(--border);
        font-weight: 600;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .btn-like:hover {
        border-color: #ff6b6b;
        color: #ff6b6b;
        transform: translateY(-2px);
      }

      .btn-like.liked {
        background: linear-gradient(135deg, #ff6b6b, #ee5a24);
        color: white;
        border-color: #ff6b6b;
        box-shadow: 0 4px 14px rgba(255, 107, 107, 0.3);
      }

      .btn-like.liked:hover {
        background: linear-gradient(135deg, #ff5252, #e53935);
        transform: translateY(-2px);
      }

      .btn-like .like-icon {
        transition: transform 0.2s ease;
      }

      .btn-like:hover .like-icon,
      .btn-like.liked .like-icon {
        transform: scale(1.2);
      }

      .post-stats {
        display: flex;
        gap: 1rem;
        color: var(--text-muted);
        font-size: 0.875rem;
      }

      .stat-item {
        display: flex;
        align-items: center;
        gap: 0.25rem;
      }

      /* Ï¢ãÏïÑÏöî Ïï†ÎãàÎ©îÏù¥ÏÖò */
      @keyframes heartBeat {
        0% {
          transform: scale(1);
        }
        14% {
          transform: scale(1.3);
        }
        28% {
          transform: scale(1);
        }
        42% {
          transform: scale(1.3);
        }
        70% {
          transform: scale(1);
        }
      }

      .btn-like.animate .like-icon {
        animation: heartBeat 0.6s ease-in-out;
      }

      /* Ï¢ãÏïÑÏöî Î™©Î°ù */
      .likes-section {
        background: var(--surface);
        border-radius: 16px;
        box-shadow: var(--shadow-lg);
        overflow: hidden;
        margin-bottom: 2rem;
      }

      .likes-header {
        padding: 1.5rem 2rem;
        border-bottom: 1px solid var(--border);
        background: var(--gray-50);
      }

      .likes-title {
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--text-primary);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .likes-list {
        padding: 1rem 2rem;
        max-height: 300px;
        overflow-y: auto;
      }

      .like-item {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.75rem 0;
        border-bottom: 1px solid var(--border);
      }

      .like-item:last-child {
        border-bottom: none;
      }

      .like-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background: linear-gradient(135deg, #ff6b6b, #ee5a24);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.875rem;
        font-weight: 600;
      }

      .like-info {
        flex: 1;
      }

      .like-user {
        font-weight: 500;
        color: var(--text-primary);
      }

      .like-date {
        font-size: 0.8rem;
        color: var(--text-muted);
      }

      .empty-likes {
        text-align: center;
        padding: 2rem;
        color: var(--text-secondary);
      }

      .comments-section {
        background: var(--surface);
        border-radius: 16px;
        box-shadow: var(--shadow-lg);
        overflow: hidden;
      }

      .comments-header {
        padding: 1.5rem 2rem;
        border-bottom: 1px solid var(--border);
        background: var(--gray-50);
      }

      .comments-title {
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--text-primary);
      }

      .comments-list {
        max-height: 600px;
        overflow-y: auto;
      }

      .comment-item {
        padding: 1.5rem 2rem;
        border-bottom: 1px solid var(--border);
      }

      .comment-item:last-child {
        border-bottom: none;
      }

      .comment-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.75rem;
      }

      .comment-meta {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .comment-actions {
        display: flex;
        gap: 0.5rem;
        opacity: 0;
        transition: opacity 0.2s;
      }

      .comment-item:hover .comment-actions {
        opacity: 1;
      }

      .comment-btn {
        background: none;
        border: none;
        cursor: pointer;
        padding: 0.25rem;
        border-radius: 4px;
        font-size: 0.875rem;
        transition: background-color 0.2s;
      }

      .comment-btn:hover {
        background-color: var(--border);
      }

      .edit-btn:hover {
        background-color: #fbbf24;
        color: white;
      }

      .delete-btn:hover {
        background-color: #ef4444;
        color: white;
      }

      .comment-author {
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .comment-avatar {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        background: var(--copper-light);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.8rem;
        font-weight: 600;
      }

      .comment-date {
        color: var(--text-muted);
        font-size: 0.8rem;
      }

      .comment-content {
        color: var(--text-primary);
        line-height: 1.6;
        white-space: pre-wrap;
      }

      .comment-form {
        padding: 2rem;
        border-top: 1px solid var(--border);
        background: var(--gray-50);
      }

      .form-group {
        margin-bottom: 1rem;
      }

      .form-label {
        display: block;
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--text-primary);
        margin-bottom: 0.5rem;
      }

      .form-input {
        width: 100%;
        padding: 0.75rem;
        border: 2px solid var(--border);
        border-radius: 8px;
        font-size: 1rem;
        transition: all 0.2s ease;
        background: var(--surface);
      }

      .form-input:focus {
        outline: none;
        border-color: var(--copper-primary);
        box-shadow: 0 0 0 3px var(--copper-shadow);
      }

      .form-textarea {
        min-height: 100px;
        resize: vertical;
        font-family: inherit;
      }

      .empty-comments {
        padding: 3rem 2rem;
        text-align: center;
        color: var(--text-secondary);
      }

      .empty-icon {
        font-size: 2rem;
        margin-bottom: 1rem;
        opacity: 0.5;
      }

      .loading {
        text-align: center;
        padding: 3rem;
        color: var(--text-secondary);
      }

      .loading-spinner {
        width: 40px;
        height: 40px;
        border: 3px solid var(--border);
        border-top: 3px solid var(--copper-primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 1rem;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      @media (max-width: 768px) {
        .container {
          padding: 2rem 1rem;
        }

        .post-title {
          font-size: 2rem;
        }

        .post-meta {
          flex-direction: column;
          align-items: flex-start;
          gap: 0.75rem;
        }

        .post-actions {
          flex-direction: column;
          gap: 1rem;
          align-items: flex-start;
        }

        .action-buttons {
          width: 100%;
          justify-content: space-between;
        }
      }

      /* Í≤åÏãúÍ∏Ä Ïù¥ÎØ∏ÏßÄ Ïä§ÌÉÄÏùº */
      .post-images {
        margin: 2rem 0;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1rem;
      }

      .post-image-item {
        border-radius: 12px;
        overflow: hidden;
        border: 1px solid var(--border);
        background: var(--surface);
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .post-image-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      }

      .post-image {
        width: 100%;
        height: 250px;
        object-fit: cover;
        display: block;
        transition: transform 0.3s ease;
      }

      .post-image:hover {
        transform: scale(1.05);
      }

      /* Ïù¥ÎØ∏ÏßÄ Î™®Îã¨ Ïä§ÌÉÄÏùº */
      .image-modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        align-items: center;
        justify-content: center;
        padding: 2rem;
      }

      .image-modal-content {
        position: relative;
        max-width: 90vw;
        max-height: 90vh;
        text-align: center;
      }

      .image-modal-img {
        max-width: 100%;
        max-height: 80vh;
        object-fit: contain;
        border-radius: 8px;
      }

      .image-modal-close {
        position: absolute;
        top: -40px;
        right: 0;
        color: white;
        font-size: 2rem;
        font-weight: bold;
        cursor: pointer;
        z-index: 1001;
      }

      .image-modal-close:hover {
        opacity: 0.7;
      }

      .image-modal-caption {
        color: white;
        margin-top: 1rem;
        font-size: 0.9rem;
        opacity: 0.8;
      }
    </style>
  </head>
  <body>
    <!-- üìå ÏÉÅÎã® Ìó§Îçî: Î∏åÎûúÎìúÎ™Ö + Î∏åÎ†àÎìúÌÅ¨Îüº ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
    <header class="header">
      <div class="header-content">
        <div class="brand-container">
          <img src="/Login/image-8.png" alt="Ordo Logo" class="logo-image" />
          <a href="/Main/index.html" class="brand">Ordo</a>
        </div>
        <!-- üó∫Ô∏è Î∏åÎ†àÎìúÌÅ¨Îüº ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò (ÎåÄÏãúÎ≥¥Îìú > Ïª§ÎÆ§ÎãàÌã∞ > Í≤åÏãúÍ∏Ä) -->
        <nav class="nav-breadcrumb">
          <a href="/Main/index.html" class="breadcrumb-link">ÎåÄÏãúÎ≥¥Îìú</a>
          <span>‚Ä∫</span>
          <a href="/board/list.html" class="breadcrumb-link">Ïª§ÎÆ§ÎãàÌã∞</a>
          <span>‚Ä∫</span>
          <span>Í≤åÏãúÍ∏Ä</span>
        </nav>
      </div>
    </header>

    <!-- üè† Î©îÏù∏ Ïª®ÌÖåÏù¥ÎÑà -->
    <div class="container">
      <!-- üìñ Í≤åÏãúÍ∏Ä Ïª®ÌÖåÏù¥ÎÑà (ÎèôÏ†ÅÏúºÎ°ú Î°úÎìúÎê®) -->
      <div class="post-container" id="postContainer">
        <div class="loading">
          <div class="loading-spinner"></div>
          <p>Í≤åÏãúÍ∏ÄÏùÑ Î∂àÎü¨Ïò§Îäî Ï§ë...</p>
        </div>
      </div>

      <!-- ‚ù§Ô∏è Ï¢ãÏïÑÏöî Î™©Î°ù ÏÑπÏÖò -->
      <div class="likes-section" id="likesSection" style="display: none">
        <div class="likes-header">
          <h3 class="likes-title">
            <span>‚ù§Ô∏è</span>
            <span>Ï¢ãÏïÑÏöî <span id="likesTotalCount">0</span>Í∞ú</span>
          </h3>
        </div>
        <div class="likes-list" id="likesList">
          <!-- Ï¢ãÏïÑÏöî Î™©Î°ù -->
        </div>
      </div>

      <!-- üí¨ ÎåìÍ∏Ä ÏÑπÏÖò -->
      <div class="comments-section" id="commentsSection" style="display: none">
        <div class="comments-header">
          <h3 class="comments-title">
            üí¨ ÎåìÍ∏Ä <span id="commentsCount">0</span>Í∞ú
          </h3>
        </div>
        <div class="comments-list" id="commentsList">
          <!-- ÎåìÍ∏Ä Î™©Î°ù -->
        </div>
        <form class="comment-form" id="commentForm">
          <div class="form-group">
            <label for="commentAuthor" class="form-label">ÏûëÏÑ±Ïûê</label>
            <input
              type="text"
              id="commentAuthor"
              class="form-input"
              placeholder="ÎãâÎÑ§ÏûÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî"
              required
            />
          </div>
          <div class="form-group">
            <label for="commentContent" class="form-label">ÎåìÍ∏Ä</label>
            <textarea
              id="commentContent"
              class="form-input form-textarea"
              placeholder="ÎåìÍ∏ÄÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî"
              required
            ></textarea>
          </div>
          <button type="submit" class="btn btn-primary">üí¨ ÎåìÍ∏Ä ÏûëÏÑ±</button>
        </form>
      </div>
    </div>

    <!-- ‚öôÔ∏è JavaScript: Í≤åÏãúÍ∏Ä ÏÉÅÏÑ∏Î≥¥Í∏∞ Í∏∞Îä• Íµ¨ÌòÑ -->
    <script>
      /**
       * üåê Ï†ÑÏó≠ Î≥ÄÏàò ÏÑ†Ïñ∏
       */
      const postId = new URLSearchParams(window.location.search).get("id"); // URLÏóêÏÑú Í≤åÏãúÍ∏Ä ID Ï∂îÏ∂ú
      let currentPost = null;   // ÌòÑÏû¨ Í≤åÏãúÍ∏Ä Îç∞Ïù¥ÌÑ∞
      let currentUser = null;   // ÌòÑÏû¨ Î°úÍ∑∏Ïù∏Ìïú ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥
      let isLikeProcessing = false; // Ï¢ãÏïÑÏöî Ï§ëÎ≥µ ÌÅ¥Î¶≠ Î∞©ÏßÄ ÌîåÎûòÍ∑∏

      /**
       * üë§ ÏÇ¨Ïö©Ïûê Ïù∏Ï¶ù ÏÉÅÌÉú ÌôïÏù∏ Ìï®Ïàò
       * - Î°úÏª¨Ïä§ÌÜ†Î¶¨ÏßÄÏóêÏÑú ÌÜ†ÌÅ∞Í≥º ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ ÌôïÏù∏
       * - Ïù∏Ï¶ù Ïã§Ìå® Ïãú Î°úÍ∑∏Ïù∏ ÌéòÏù¥ÏßÄÎ°ú Î¶¨Îã§Ïù¥Î†âÌä∏
       * @returns {boolean} Ïù∏Ï¶ù ÏÑ±Í≥µ Ïó¨Î∂Ä
       */
      function checkUserAuthentication() {
        const token = localStorage.getItem("token");
        const user = localStorage.getItem("user");

        if (!token || !user) {
          console.log(
            "ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§. Î°úÍ∑∏Ïù∏ ÌéòÏù¥ÏßÄÎ°ú Ïù¥ÎèôÌï©ÎãàÎã§."
          );
          alert("ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§. Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.");
          window.location.href = "/Login/email-login.html";
          return false;
        }

        try {
          currentUser = JSON.parse(user);
          if (!currentUser.name) {
            throw new Error("ÏÇ¨Ïö©Ïûê Ïù¥Î¶ÑÏù¥ ÏóÜÏäµÎãàÎã§.");
          }
          return true;
        } catch (error) {
          console.error("ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ ÌååÏã± Ïò§Î•ò:", error);
          alert("ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥Í∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§. Îã§Ïãú Î°úÍ∑∏Ïù∏Ìï¥Ï£ºÏÑ∏Ïöî.");
          localStorage.removeItem("token");
          localStorage.removeItem("user");
          window.location.href = "/Login/email-login.html";
          return false;
        }
      }

      /**
       * üì± ÌéòÏù¥ÏßÄ Î°úÎî© ÏôÑÎ£å ÌõÑ Ï¥àÍ∏∞Ìôî
       * - Í≤åÏãúÍ∏Ä ID ÌôïÏù∏
       * - ÏÇ¨Ïö©Ïûê Ïù∏Ï¶ù ÏÉÅÌÉú ÌôïÏù∏
       * - Í≤åÏãúÍ∏Ä, ÎåìÍ∏Ä, Ï¢ãÏïÑÏöî Îç∞Ïù¥ÌÑ∞ Î°úÎìú
       * - Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà ÏÑ§Ï†ï
       */
      document.addEventListener("DOMContentLoaded", async () => {
        if (!postId) {
          showError("Í≤åÏãúÍ∏Ä IDÍ∞Ä ÏóÜÏäµÎãàÎã§.");
          return;
        }

        // ÏÇ¨Ïö©Ïûê Ïù∏Ï¶ù ÌôïÏù∏
        if (!checkUserAuthentication()) {
          return; // Ïù∏Ï¶ù Ïã§Ìå® Ïãú Ïó¨Í∏∞ÏÑú Ï¢ÖÎ£å
        }

        await loadPost();       // Í≤åÏãúÍ∏Ä Î°úÎìú
        await loadComments();   // ÎåìÍ∏Ä Î°úÎìú  
        await loadLikeStatus(); // Ï¢ãÏïÑÏöî ÏÉÅÌÉú Î°úÎìú
        setupCommentForm();     // ÎåìÍ∏Ä Ìèº ÏÑ§Ï†ï
        setupLikeButton();      // Ï¢ãÏïÑÏöî Î≤ÑÌäº ÏÑ§Ï†ï
      });

      /**
       * üìñ Í≤åÏãúÍ∏Ä Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ìï®Ïàò
       * - APIÏóêÏÑú Í≤åÏãúÍ∏Ä ÏÉÅÏÑ∏ Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞
       * - Ï°∞ÌöåÏàò Ï¶ùÍ∞Ä Ï≤òÎ¶¨
       * - Í≤åÏãúÍ∏Ä UI Î†åÎçîÎßÅ
       */

      async function loadPost() {
        try {
          const response = await fetch(`/api/posts/${postId}`);
          if (!response.ok) throw new Error("Failed to fetch post");

          const data = await response.json();
          console.log("Î∞õÏùÄ Í≤åÏãúÍ∏Ä Îç∞Ïù¥ÌÑ∞:", data); // ÎîîÎ≤ÑÍπÖÏö©

          // ÏÑúÎ≤Ñ ÏùëÎãµ ÌòïÌÉúÏóê Îî∞Îùº Ï≤òÎ¶¨
          currentPost = data.post || data;

          if (!currentPost.title) {
            console.error("Í≤åÏãúÍ∏Ä Îç∞Ïù¥ÌÑ∞Í∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§:", currentPost);
            throw new Error("Í≤åÏãúÍ∏Ä Îç∞Ïù¥ÌÑ∞Í∞Ä Ïò¨Î∞îÎ•¥ÏßÄ ÏïäÏäµÎãàÎã§.");
          }

          renderPost(currentPost);

          // Ï°∞ÌöåÏàò Ï¶ùÍ∞Ä
          await updateViews();
        } catch (error) {
          console.error("Í≤åÏãúÍ∏Ä Î°úÎî© Ïò§Î•ò:", error);
          showError("Í≤åÏãúÍ∏ÄÏùÑ Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.");
        }
      }

      function renderPost(post) {
        const container = document.getElementById("postContainer");

        // ÏïàÏ†ÑÌïú Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨
        const title = post.title || "Ï†úÎ™© ÏóÜÏùå";
        const author = post.author || "ÏùµÎ™Ö";
        const content = post.content || "";
        const category = post.category || "tips";

        console.log("Î†åÎçîÎßÅÌï† Í≤åÏãúÍ∏Ä Îç∞Ïù¥ÌÑ∞:", {
          title,
          author,
          content,
          category,
        }); // ÎîîÎ≤ÑÍπÖÏö©

        container.innerHTML = `
                <div class="post-header">
                    <div class="post-category">${getCategoryName(
                      category
                    )}</div>
                    <h1 class="post-title">${title}</h1>
                    <div class="post-meta">
                        <div class="author-info">
                            <div class="author-avatar">${author
                              .charAt(0)
                              .toUpperCase()}</div>
                            <span>${author}</span>
                        </div>
                        <div class="meta-item">
                            <span>üìÖ</span>
                            <span>${formatDate(post.createdAt)}</span>
                        </div>
                        <div class="meta-item">
                            <span>üëÄ</span>
                            <span>${post.views || 0}Ìöå</span>
                        </div>
                    </div>
                    ${
                      post.tags && post.tags.length > 0
                        ? `
                        <div class="post-tags">
                            ${post.tags
                              .map((tag) => `<span class="tag">#${tag}</span>`)
                              .join("")}
                        </div>
                    `
                        : ""
                    }
                </div>
                <div class="post-content">
                    ${formatContent(content)}
                    ${renderPostImages(post.images || [])}
                </div>
                <div class="post-actions">
                    <div class="action-buttons">
                        <button class="btn btn-like" id="likeBtn">
                            <span class="like-icon">‚ù§Ô∏è</span>
                            <span id="likeText">Ï¢ãÏïÑÏöî</span>
                        </button>
                        <a href="/board/list.html" class="btn btn-secondary">üìã Î™©Î°ùÏúºÎ°ú</a>
                        <a href="/board/write.html" class="btn btn-primary">‚úçÔ∏è Í∏ÄÏì∞Í∏∞</a>
                        <div id="authorActions" style="display: none;">
                            <a href="#" id="editBtn" class="btn btn-warning">‚úèÔ∏è ÏàòÏ†ï</a>
                            <button id="deleteBtn" class="btn btn-danger">üóëÔ∏è ÏÇ≠Ï†ú</button>
                        </div>
                    </div>
                    <div class="post-stats">
                        <div class="stat-item">
                            <span>üëÄ</span>
                            <span>Ï°∞Ìöå <span id="viewCount">${
                              post.views || 0
                            }</span></span>
                        </div>
                        <div class="stat-item">
                            <span>‚ù§Ô∏è</span>
                            <span>Ï¢ãÏïÑÏöî <span id="likesCount">${
                              post.likesCount || 0
                            }</span></span>
                        </div>
                        <div class="stat-item">
                            <span>üí¨</span>
                            <span>ÎåìÍ∏Ä <span id="postCommentsCount">0</span></span>
                        </div>
                    </div>
                </div>
            `;

        // Ï¢ãÏïÑÏöî ÏÑπÏÖòÍ≥º ÎåìÍ∏Ä ÏÑπÏÖò ÌëúÏãú
        document.getElementById("likesSection").style.display = "block";
        document.getElementById("commentsSection").style.display = "block";

        // ÏûëÏÑ±Ïûê ÌôïÏù∏ÌïòÏó¨ ÏàòÏ†ï/ÏÇ≠Ï†ú Î≤ÑÌäº ÌëúÏãú
        console.log("ÏûëÏÑ±Ïûê ÌôïÏù∏:", {
          currentUserName: currentUser.name,
          postAuthor: author,
        }); // ÎîîÎ≤ÑÍπÖÏö©
        if (currentUser.name && author && currentUser.name === author) {
          document.getElementById("authorActions").style.display = "flex";
          setupAuthorActions();
        }

        // Ï¢ãÏïÑÏöî Î≤ÑÌäº ÏÑ§Ï†ï
        setupLikeButton();
      }

      function renderPostImages(images) {
        if (!images || images.length === 0) {
          return "";
        }

        return `
          <div class="post-images">
            ${images
              .map(
                (image) => `
              <div class="post-image-item">
                <img
                  src="${
                    image.url || `/api/posts/images/${image.fileId || image.id}`
                  }"
                  alt="${image.originalName || image.name || "Ïù¥ÎØ∏ÏßÄ"}"
                  class="post-image"
                  onclick="openImageModal(this.src, '${
                    image.originalName || image.name || "Ïù¥ÎØ∏ÏßÄ"
                  }')"
                />
              </div>
            `
              )
              .join("")}
          </div>
        `;
      }

      function openImageModal(src, alt) {
        const modal = document.createElement("div");
        modal.className = "image-modal";
        modal.innerHTML = `
          <div class="image-modal-content">
            <span class="image-modal-close" onclick="closeImageModal()">&times;</span>
            <img src="${src}" alt="${alt}" class="image-modal-img">
            <div class="image-modal-caption">${alt}</div>
          </div>
        `;

        document.body.appendChild(modal);
        modal.style.display = "flex";

        // ESC ÌÇ§Î°ú Îã´Í∏∞
        document.addEventListener("keydown", function (e) {
          if (e.key === "Escape") {
            closeImageModal();
          }
        });
      }

      function closeImageModal() {
        const modal = document.querySelector(".image-modal");
        if (modal) {
          modal.remove();
        }
      }

      async function loadLikeStatus() {
        try {
          const userId = currentUser.id || "";
          const response = await fetch(
            `/api/posts/${postId}/like-status?userId=${userId}`
          );
          if (!response.ok) throw new Error("Failed to fetch like status");

          const data = await response.json();
          updateLikeUI(data.isLiked, data.likesCount);
          renderLikes(data.likes || []);
        } catch (error) {
          console.error("Ï¢ãÏïÑÏöî ÏÉÅÌÉú Î°úÎî© Ïò§Î•ò:", error);
        }
      }

      function setupLikeButton() {
        const likeBtn = document.getElementById("likeBtn");
        if (!likeBtn) return;

        likeBtn.addEventListener("click", async () => {
          if (!currentUser.id) {
            alert("Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.");
            return;
          }

          // Ï§ëÎ≥µ ÌÅ¥Î¶≠ Î∞©ÏßÄ
          if (isLikeProcessing) {
            console.log("Ï¢ãÏïÑÏöî Ï≤òÎ¶¨ Ï§ë... Ïû†ÏãúÎßå Í∏∞Îã§Î†§Ï£ºÏÑ∏Ïöî.");
            return;
          }

          try {
            isLikeProcessing = true;
            likeBtn.disabled = true;
            likeBtn.style.opacity = "0.5";

            const response = await fetch(`/api/posts/${postId}/like`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                userId: currentUser.id,
                userName: currentUser.name,
              }),
            });

            if (!response.ok) throw new Error("Ï¢ãÏïÑÏöî Ï≤òÎ¶¨ Ïã§Ìå®");

            const data = await response.json();

            // ÏÑúÎ≤Ñ ÏùëÎãµÏúºÎ°ú UI ÏóÖÎç∞Ïù¥Ìä∏ (Ï§ëÎ≥µ Î°úÎî© Ï†úÍ±∞)
            updateLikeUI(data.isLiked, data.likesCount);
            renderLikes(data.likes || []);

            // Ïï†ÎãàÎ©îÏù¥ÏÖò Ìö®Í≥º
            likeBtn.classList.add("animate");
            setTimeout(() => likeBtn.classList.remove("animate"), 600);
          } catch (error) {
            console.error("Ï¢ãÏïÑÏöî Ï≤òÎ¶¨ Ïò§Î•ò:", error);
            alert("Ï¢ãÏïÑÏöî Ï≤òÎ¶¨ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.");
          } finally {
            // 0.5Ï¥à ÌõÑÏóê Îã§Ïãú ÌÅ¥Î¶≠ Í∞ÄÎä•ÌïòÎèÑÎ°ù ÏÑ§Ï†ï
            setTimeout(() => {
              isLikeProcessing = false;
              likeBtn.disabled = false;
              likeBtn.style.opacity = "1";
            }, 500);
          }
        });
      }

      function setupAuthorActions() {
        const editBtn = document.getElementById("editBtn");
        const deleteBtn = document.getElementById("deleteBtn");

        // ÏàòÏ†ï Î≤ÑÌäº
        if (editBtn) {
          editBtn.href = `/board/edit.html?id=${postId}`;
        }

        // ÏÇ≠Ï†ú Î≤ÑÌäº
        if (deleteBtn) {
          deleteBtn.addEventListener("click", async () => {
            if (
              !confirm(
                "Ï†ïÎßêÎ°ú Ïù¥ Í≤åÏãúÍ∏ÄÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?\nÏÇ≠Ï†úÎêú Í≤åÏãúÍ∏ÄÏùÄ Î≥µÍµ¨Ìï† Ïàò ÏóÜÏäµÎãàÎã§."
              )
            ) {
              return;
            }

            deleteBtn.disabled = true;
            deleteBtn.innerHTML = "üóëÔ∏è ÏÇ≠Ï†ú Ï§ë...";

            try {
              const response = await fetch(
                `/api/posts/${postId}?authorCheck=${encodeURIComponent(
                  currentUser.name
                )}`,
                {
                  method: "DELETE",
                }
              );

              const result = await response.json();

              if (response.ok) {
                alert("Í≤åÏãúÍ∏ÄÏù¥ ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.");
                window.location.href = "/board/list.html";
              } else {
                throw new Error(
                  result.message || "Í≤åÏãúÍ∏Ä ÏÇ≠Ï†úÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§."
                );
              }
            } catch (error) {
              console.error("Í≤åÏãúÍ∏Ä ÏÇ≠Ï†ú Ïò§Î•ò:", error);
              alert("Í≤åÏãúÍ∏Ä ÏÇ≠Ï†ú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: " + error.message);

              deleteBtn.disabled = false;
              deleteBtn.innerHTML = "üóëÔ∏è ÏÇ≠Ï†ú";
            }
          });
        }
      }

      function updateLikeUI(isLiked, likesCount) {
        const likeBtn = document.getElementById("likeBtn");
        const likeText = document.getElementById("likeText");
        const likesCountEl = document.getElementById("likesCount");
        const likesTotalCountEl = document.getElementById("likesTotalCount");

        if (likeBtn) {
          if (isLiked) {
            likeBtn.classList.add("liked");
            likeText.textContent = "Ï¢ãÏïÑÏöî Ï∑®ÏÜå";
          } else {
            likeBtn.classList.remove("liked");
            likeText.textContent = "Ï¢ãÏïÑÏöî";
          }
        }

        if (likesCountEl) {
          likesCountEl.textContent = likesCount || 0;
        }

        if (likesTotalCountEl) {
          likesTotalCountEl.textContent = likesCount || 0;
        }
      }

      function renderLikes(likes) {
        const container = document.getElementById("likesList");

        if (!likes || likes.length === 0) {
          container.innerHTML = `
            <div class="empty-likes">
              <div style="font-size: 2rem; margin-bottom: 1rem; opacity: 0.5;">‚ù§Ô∏è</div>
              <p>ÏïÑÏßÅ Ï¢ãÏïÑÏöîÍ∞Ä ÏóÜÏäµÎãàÎã§.<br>Ï≤´ Î≤àÏß∏ Ï¢ãÏïÑÏöîÎ•º ÎàåÎü¨Î≥¥ÏÑ∏Ïöî!</p>
            </div>
          `;
          return;
        }

        container.innerHTML = likes
          .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
          .map(
            (like) => `
              <div class="like-item">
                <div class="like-avatar">${(like.userName || "?")
                  .charAt(0)
                  .toUpperCase()}</div>
                <div class="like-info">
                  <div class="like-user">${like.userName || "ÏùµÎ™Ö"}</div>
                  <div class="like-date">${formatDate(like.createdAt)}</div>
                </div>
              </div>
            `
          )
          .join("");
      }

      async function loadComments() {
        try {
          const response = await fetch(`/api/posts/${postId}/comments`);
          if (!response.ok) throw new Error("Failed to fetch comments");

          const comments = await response.json();
          renderComments(comments);
          updateCommentsCount(comments.length);
        } catch (error) {
          console.error("ÎåìÍ∏Ä Î°úÎî© Ïò§Î•ò:", error);
          renderComments([]);
        }
      }

      function renderComments(comments) {
        const container = document.getElementById("commentsList");

        if (comments.length === 0) {
          container.innerHTML = `
                    <div class="empty-comments">
                        <div class="empty-icon">üí¨</div>
                        <p>ÏïÑÏßÅ ÎåìÍ∏ÄÏù¥ ÏóÜÏäµÎãàÎã§.<br>Ï≤´ Î≤àÏß∏ ÎåìÍ∏ÄÏùÑ ÏûëÏÑ±Ìï¥Î≥¥ÏÑ∏Ïöî!</p>
                    </div>
                `;
          return;
        }

        container.innerHTML = comments
          .map(
            (comment) => `
                <div class="comment-item" data-comment-id="${comment._id}">
                    <div class="comment-header">
                        <div class="comment-author">
                            <div class="comment-avatar">${(
                              comment.author || "?"
                            )
                              .charAt(0)
                              .toUpperCase()}</div>
                            <span>${comment.author || "ÏùµÎ™Ö"}</span>
                        </div>
                        <div class="comment-meta">
                            <span class="comment-date">${formatDate(
                              comment.createdAt
                            )}</span>
                            ${
                              currentUser.name &&
                              comment.author &&
                              currentUser.name === comment.author
                                ? `
                            <div class="comment-actions">
                                <button onclick="editComment('${
                                  comment._id
                                }', '${
                                    comment.text || comment.content
                                  }')" class="comment-btn edit-btn">‚úèÔ∏è</button>
                                <button onclick="deleteComment('${
                                  comment._id
                                }')" class="comment-btn delete-btn">üóëÔ∏è</button>
                            </div>
                            `
                                : ""
                            }
                        </div>
                    </div>
                    <div class="comment-content" id="comment-content-${
                      comment._id
                    }">${comment.text || comment.content}</div>
                </div>
            `
          )
          .join("");
      }

      function setupCommentForm() {
        const form = document.getElementById("commentForm");

        // Î°úÍ∑∏Ïù∏Îêú ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥Î°ú ÏûêÎèô ÏûÖÎ†•
        if (currentUser.name) {
          document.getElementById("commentAuthor").value = currentUser.name;
        }

        form.addEventListener("submit", async (e) => {
          e.preventDefault();
          await submitComment();
        });
      }

      async function submitComment() {
        const author = document.getElementById("commentAuthor").value;
        const content = document.getElementById("commentContent").value;

        if (!author.trim() || !content.trim()) {
          alert("ÏûëÏÑ±ÏûêÏôÄ ÎåìÍ∏Ä ÎÇ¥Ïö©ÏùÑ Î™®Îëê ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.");
          return;
        }

        try {
          const response = await fetch(`/api/posts/${postId}/comments`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              author: author.trim(),
              text: content.trim(),
            }),
          });

          if (response.ok) {
            // Ìèº Ï¥àÍ∏∞Ìôî
            document.getElementById("commentContent").value = "";

            // ÎåìÍ∏Ä Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®
            await loadComments();
          } else {
            throw new Error("ÎåìÍ∏Ä ÏûëÏÑ±Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.");
          }
        } catch (error) {
          console.error("ÎåìÍ∏Ä ÏûëÏÑ± Ïò§Î•ò:", error);
          alert("ÎåìÍ∏Ä ÏûëÏÑ± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.");
        }
      }

      async function updateViews() {
        try {
          await fetch(`/api/posts/${postId}/view`, {
            method: "POST",
          });
        } catch (error) {
          console.error("Ï°∞ÌöåÏàò ÏóÖÎç∞Ïù¥Ìä∏ Ïò§Î•ò:", error);
        }
      }

      function updateCommentsCount(count) {
        document.getElementById("commentsCount").textContent = count;
        const postCommentsCount = document.getElementById("postCommentsCount");
        if (postCommentsCount) {
          postCommentsCount.textContent = count;
        }
      }

      function getCategoryName(category) {
        const categories = {
          productivity: "üìà ÏÉùÏÇ∞ÏÑ±",
          routine: "üîÑ Î£®Ìã¥",
          tips: "üí° ÌåÅ",
          qna: "‚ùì ÏßàÎ¨∏ÎãµÎ≥Ä",
        };
        return categories[category] || "üí° ÌåÅ";
      }

      function formatContent(content) {
        // contentÍ∞Ä ÏóÜÏúºÎ©¥ Îπà Î¨∏ÏûêÏó¥ Î∞òÌôò
        if (!content) {
          return "";
        }

        // Ï§ÑÎ∞îÍøàÏùÑ <br>Î°ú Î≥ÄÌôòÌïòÍ≥† Í∏∞Î≥∏Ï†ÅÏù∏ Ìè¨Îß∑ÌåÖ Ï†ÅÏö©
        return content
          .replace(/\n/g, "<br>")
          .replace(/‚Ä¢\s/g, "<br>‚Ä¢ ")
          .replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>");
      }

      function formatDate(dateString) {
        const date = new Date(dateString);
        const now = new Date();
        const diff = now - date;
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));

        if (days === 0) {
          const hours = Math.floor(diff / (1000 * 60 * 60));
          if (hours === 0) {
            const minutes = Math.floor(diff / (1000 * 60));
            return minutes <= 0 ? "Î∞©Í∏à Ï†Ñ" : `${minutes}Î∂Ñ Ï†Ñ`;
          }
          return `${hours}ÏãúÍ∞Ñ Ï†Ñ`;
        } else if (days === 1) {
          return "Ïñ¥Ï†ú";
        } else if (days < 7) {
          return `${days}Ïùº Ï†Ñ`;
        } else {
          return date.toLocaleDateString("ko-KR", {
            year: "numeric",
            month: "long",
            day: "numeric",
          });
        }
      }

      function showError(message) {
        const container = document.getElementById("postContainer");
        container.innerHTML = `
                <div style="text-align: center; padding: 3rem; color: var(--text-secondary);">
                    <div style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;">‚ö†Ô∏è</div>
                    <h2 style="margin-bottom: 1rem;">Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§</h2>
                    <p style="margin-bottom: 2rem;">${message}</p>
                    <a href="/board/list.html" class="btn btn-primary">Î™©Î°ùÏúºÎ°ú ÎèåÏïÑÍ∞ÄÍ∏∞</a>
                </div>
            `;
      }

      // ÎåìÍ∏Ä ÏàòÏ†ï Ìï®Ïàò
      async function editComment(commentId, currentText) {
        const newText = prompt("ÎåìÍ∏ÄÏùÑ ÏàòÏ†ïÌïòÏÑ∏Ïöî:", currentText);
        if (!newText || newText.trim() === "" || newText === currentText) {
          return;
        }

        try {
          const response = await fetch(
            `/api/posts/${postId}/comments/${commentId}?authorCheck=${encodeURIComponent(
              currentUser.name
            )}`,
            {
              method: "PUT",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                text: newText.trim(),
              }),
            }
          );

          const result = await response.json();

          if (response.ok) {
            // ÎåìÍ∏Ä ÎÇ¥Ïö©Îßå ÏóÖÎç∞Ïù¥Ìä∏
            const contentEl = document.getElementById(
              `comment-content-${commentId}`
            );
            if (contentEl) {
              contentEl.textContent = newText.trim();
            }
          } else {
            throw new Error(result.message || "ÎåìÍ∏Ä ÏàòÏ†ïÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.");
          }
        } catch (error) {
          console.error("ÎåìÍ∏Ä ÏàòÏ†ï Ïò§Î•ò:", error);
          alert("ÎåìÍ∏Ä ÏàòÏ†ï Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: " + error.message);
        }
      }

      // ÎåìÍ∏Ä ÏÇ≠Ï†ú Ìï®Ïàò
      async function deleteComment(commentId) {
        if (!confirm("Ï†ïÎßêÎ°ú Ïù¥ ÎåìÍ∏ÄÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?")) {
          return;
        }

        try {
          const response = await fetch(
            `/api/posts/${postId}/comments/${commentId}?authorCheck=${encodeURIComponent(
              currentUser.name
            )}`,
            {
              method: "DELETE",
            }
          );

          const result = await response.json();

          if (response.ok) {
            // ÎåìÍ∏Ä Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®
            await loadComments();
          } else {
            throw new Error(result.message || "ÎåìÍ∏Ä ÏÇ≠Ï†úÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.");
          }
        } catch (error) {
          console.error("ÎåìÍ∏Ä ÏÇ≠Ï†ú Ïò§Î•ò:", error);
          alert("ÎåìÍ∏Ä ÏÇ≠Ï†ú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§: " + error.message);
        }
      }
    </script>
  </body>
</html>
